-- Load Redzhub Library V2
loadstring(game:HttpGet("https://raw.githubusercontent.com/REDzHUB/LibraryV2/main/redzLib"))()

-- Create UI Window
local UI = MakeWindow({
    Hub = {Title = "Murder Mystery 2 - Star X", Animation = "Hope You Like It "},
    Key = {KeySystem = false}  -- Disable key system
})

-- Create Tabs
local MainTab = MakeTab({Name = "Main"})
local MurderTab = MakeTab({Name = "Murder"})
local SheriffTab = MakeTab({Name = "Sheriff"})
local ESPTab = MakeTab({Name = "ESP"})
local PlayersTab = MakeTab({Name = "Players"})
local MiscTab = MakeTab({Name = "Misc"})

-- UI Toggle Logic
local UIVisible = true
local function toggleUI()
    UIVisible = not UIVisible
    if UIVisible then
        UI.Show()
    else
        UI.Hide()
    end
end

-- Add UI Toggle Button
AddButton(MiscTab, {
    Name = "Toggle UI",
    Callback = toggleUI
})

-- **Main Tab Features**

-- Player Chams (Color-coded roles)
AddToggle(MainTab, {
    Name = "Player Chams",
    Callback = function(state)
        for _, player in pairs(game.Players:GetPlayers()) do
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local role = player.Role.Value  -- Replace with actual role retrieval logic
                local color = (role == "Murderer" and BrickColor.Red()) or
                              (role == "Sheriff" and BrickColor.Blue()) or
                              BrickColor.White()
                player.Character.HumanoidRootPart.BrickColor = color
            end
        end
    end
})

-- Auto Grab Gun
AddToggle(MainTab, {
    Name = "Auto Grab Gun",
    Callback = function(state)
        while state do
            local gun = workspace:FindFirstChild("GunDrop")
            if gun then
                game.Players.LocalPlayer.Character:MoveTo(gun.Position)
            end
            wait(1)
        end
    end
})

-- Coin Farming with Teleport Bypass
AddToggle(MainTab, {
    Name = "Farm Coins",
    Callback = function(state)
        while state do
            for _, coin in pairs(workspace:GetChildren()) do
                if coin.Name == "Coin" then
                    game.Players.LocalPlayer.Character:MoveTo(coin.Position)
                    wait(0.9)
                end
            end
        end
    end
})

-- Xray Toggle
AddToggle(MainTab, {
    Name = "Xray",
    Callback = function(state)
        game.Players.LocalPlayer.Character.HumanoidRootPart.Transparency = state and 0.5 or 0
    end
})

-- Fling Murderer
AddToggle(MainTab, {
    Name = "Fling Murderer",
    Callback = function(state)
        if state then
            local murderer = game.Players:FindFirstChildWhichIsA("Murderer")
            if murderer and murderer.Character then
                murderer.Character.HumanoidRootPart.Velocity = Vector3.new(999, 999, 999)
            end
        end
    end
})

-- **Murder Tab: Auto Kill All**
AddToggle(MurderTab, {
    Name = "Auto Kill All",
    Callback = function(state)
        while state do
            for _, player in pairs(game.Players:GetPlayers()) do
                if player ~= game.Players.LocalPlayer then
                    -- Trigger attack logic
                end
            end
            wait(1)
        end
    end
})

-- **Sheriff Tab: Auto Aim Bot**
AddToggle(SheriffTab, {
    Name = "Auto Aim Bot",
    Callback = function(state)
        while state do
            local closestPlayer = nil
            local shortestDistance = math.huge

            for _, player in pairs(game.Players:GetPlayers()) do
                if player ~= game.Players.LocalPlayer and player.Character then
                    local distance = (player.Character.HumanoidRootPart.Position - 
                                      game.Players.LocalPlayer.Character.HumanoidRootPart.Position).magnitude
                    if distance < shortestDistance then
                        shortestDistance = distance
                        closestPlayer = player
                    end
                end
            end

            if closestPlayer then
                -- Align camera or aim at closest player
            end
            wait(0.1)
        end
    end
})

-- **ESP Tab: Gun and Player ESP**
AddToggle(ESPTab, {
    Name = "Gun ESP",
    Callback = function(state)
        while state do
            for _, gun in pairs(workspace:GetChildren()) do
                if gun.Name == "GunDrop" then
                    -- Draw ESP marker around the gun
                end
            end
            wait(0.1)
        end
    end
})

AddToggle(ESPTab, {
    Name = "Player ESP",
    Callback = function(state)
        while state do
            for _, player in pairs(game.Players:GetPlayers()) do
                if player.Character and player.Character:FindFirstChild("Head") then
                    -- Draw ESP tag above player's head with role color
                end
            end
            wait(0.1)
        end
    end
})

-- **Players Tab: WalkSpeed, JumpPower, and Fly**
AddSlider(PlayersTab, {
    Name = "WalkSpeed",
    MinValue = 10,
    MaxValue = 1000,
    Default = 16,
    Callback = function(value)
        game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = value
    end
})

AddSlider(PlayersTab, {
    Name = "JumpPower",
    MinValue = 10,
    MaxValue = 1000,
    Default = 50,
    Callback = function(value)
        game.Players.LocalPlayer.Character.Humanoid.JumpPower = value
    end
})

-- Fly Logic
local flying = false
local flySpeed = 50
local flyConnection

local function enableFly()
    local player = game.Players.LocalPlayer
    local hrp = player.Character:WaitForChild("HumanoidRootPart")

    flying = true
    flyConnection = game:GetService("RunService").RenderStepped:Connect(function()
        if flying then
            local moveDir = Vector3.zero
            local uis = game:GetService("UserInputService")

            if uis:IsKeyDown(Enum.KeyCode.W) then
                moveDir += hrp.CFrame.LookVector
            end
            if uis:IsKeyDown(Enum.KeyCode.S) then
                moveDir -= hrp.CFrame.LookVector
            end
            if uis:IsKeyDown(Enum.KeyCode.A) then
                moveDir -= hrp.CFrame.RightVector
            end
            if uis:IsKeyDown(Enum.KeyCode.D) then
                moveDir += hrp.CFrame.RightVector
            end
            if uis:IsKeyDown(Enum.KeyCode.Space) then
                moveDir += Vector3.new(0, 1, 0)
            end
            if uis:IsKeyDown(Enum.KeyCode.LeftShift) then
                moveDir -= Vector3.new(0, 1, 0)
            end

            hrp.Velocity = moveDir.Unit * flySpeed
        end
    end)
end

local function disableFly()
    if flyConnection then flyConnection:Disconnect() end
    flying = false
end

AddToggle(PlayersTab, {
    Name = "Fly",
    Callback = function(state)
        if state then
            enableFly()
        else
            disableFly()
        end
    end
})

-- **Misc Tab: UI Color and Discord Link**
AddColorPicker(MiscTab, {
    Name = "UI Color",
    Callback = function(color)
        UI.SetColor(color)
    end
})

AddButton(MiscTab, {
    Name = "Copy Discord Link",
    Callback = function()
        setclipboard("https://discord.gg/EwARkGncq4")
    end
})

--Ui
loadstring(game:HttpGet("https://raw.githubusercontent.com/StarX-exploit/blade-ui/refs/heads/main/ui-star"))()
